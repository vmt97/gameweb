{"version":3,"sources":["../../../../assets/scripts/assets/scripts/GameController.js"],"names":["GameController","cc","Class","extends","Component","properties","listImage","default","type","SpriteFrame","square","Prefab","listSquare","tmpSquare","UIController","require","score","canPlay","statics","instance","onLoad","initLevel","hidePlayButton","index","typeCreate","action1","delayTime","action2","callFunc","createSquare","action3","node","runAction","sequence","repeat","length","setUpPositionSquares","maxRow","maxCol","row","col","x","y","moveAction","moveTo","easing","easeBackInOut","spriteFrame","instantiate","parent","emit","setPosition","push","radomInteger","min","max","Math","ceil","floor","random","randomElementInArray","arr","getTmpSquare","setTmpSquare","clearTmpSquare","removeSquare","indexOf","splice","setCanPlay","checkWinGame","showVictory","countScore","setScore","showScore","playAgain","hideUIplayAgain","isCanPlay"],"mappings":"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","file":"GameController.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["var GameController = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        listImage: {\n            default: [],\n            type: cc.SpriteFrame\n        },\n\n        square: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        listSquare: {\n            default: [],\n            type: cc.Prefab\n        },\n\n        tmpSquare: {\n            default: null,\n            type: cc.Prefab\n        },\n        UIController: require(\"UIConTroller\"),\n        score: 0,\n        canPlay: true\n\n\n    },\n\n    statics: {\n        instance: null\n    },\n\n    onLoad() {\n        GameController.instance = this;\n        this.score = 0;\n    },\n\n\n    initLevel: function () {\n        this.UIController.hidePlayButton();\n        let index = 0;\n        let typeCreate = 0;\n        let action1 = cc.delayTime(0.1);\n        let action2 = cc.callFunc(() => {\n            index++;\n            this.createSquare(index, typeCreate, this.listImage[typeCreate]);\n        }, this);\n        let action3 = cc.callFunc(() => {\n            index++;\n            this.createSquare(index, typeCreate, this.listImage[typeCreate]);\n            typeCreate++;\n        }, this);\n\n        this.node.runAction(cc.sequence(\n            cc.repeat(cc.sequence(action1, action2, action3), this.listImage.length),\n            cc.delayTime(1),\n            cc.callFunc(() => {\n                this.setUpPositionSquares();\n            })\n        )\n        );\n    },\n\n    setUpPositionSquares() {\n        let maxRow = 4;\n        let maxCol = 5;\n        let index = 0;\n        // this.listSquare = this.listSquare.sort(() => Math.random() - 0.5);\n        for (let row = 0; row < maxRow; row++) {\n            for (let col = 0; col < maxCol; col++) {\n\n                let x = - 130 + (col * 64);\n                let y = 150 + (-row * 64);\n\n                let square = this.listSquare[index];\n                let moveAction = cc.moveTo(1, x, y).easing(cc.easeBackInOut());\n                let sequence = cc.sequence(\n                    cc.delayTime(0.1 * index),\n                    moveAction,\n                );\n                square.runAction(sequence);\n                index++;\n            }\n        }\n    },\n\n    createSquare(index, type, spriteFrame) {\n        let square = cc.instantiate(this.square);\n        square.parent = this.node;\n        // index++;\n        square.emit(\"INIT_INFO\", index, type, spriteFrame);\n        square.setPosition(0, -130, 0);\n        this.listSquare.push(square);\n    },\n\n    radomInteger: function (min, max) {\n        min = Math.ceil(min);\n        max = Math.floor(max);\n        return Math.floor(Math.random() * (max - min) + min);\n    },\n\n    //4\n    randomElementInArray: function (arr) {\n        let index = radomInteger(0, arr.length - 1);\n        return arr[index];\n    },\n\n\n    getTmpSquare() {\n        return this.tmpSquare;\n    },\n\n    setTmpSquare(square) {\n        this.tmpSquare = square;\n    },\n\n    clearTmpSquare() {\n        this.tmpSquare = null;\n    },\n\n    removeSquare(square) {\n        let index = this.listSquare.indexOf(square);\n        this.listSquare.splice(index, 1);\n        this.setCanPlay(true);\n    },\n\n    checkWinGame() {\n        if (this.listSquare.length > 0)\n            return;\n            this.UIController.showVictory();\n    },\n\n    countScore() {\n        let action1 = cc.delayTime(0.1);\n        let action2 = cc.callFunc(() => {\n            this.score += 1;\n            this.setScore();\n        }, this);\n        this.node.runAction(cc.repeat(cc.sequence(action1, action2), 10));\n    },\n\n    setScore() {\n        this.UIController.showScore(this.score);\n    },\n\n    playAgain() {\n        this.UIController.hideUIplayAgain();\n        this.initLevel();\n    },\n\n    setCanPlay(canPlay) {\n        this.canPlay = canPlay;\n    },\n\n    isCanPlay() {\n        return this.canPlay;\n    }\n\n});\n"]}